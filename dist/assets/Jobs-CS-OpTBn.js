import{r as a,j as e,U as B,B as E,T as m,H as J,x as j,R,M as N,S as H,V as L}from"./index-DmmLrvYi.js";import{C as V,T as W,a as F,b as I,c as T,d as h,e as O}from"./CardSecondaryAction-DNHgl_JW.js";import{s as g}from"./supabase--8ANMFph.js";import{S as k,A}from"./Snackbar-GfMR6gKJ.js";const P=({open:y,onClose:c,setSuccessMessage:w})=>{const[x,f]=a.useState(""),[d,v]=a.useState(""),[b,n]=a.useState(""),[l,u]=a.useState(!1),[o,p]=a.useState(null),S=async()=>{if(!x||!d||!b){p("All fields are required");return}u(!0);try{const{error:r}=await g.from("category").insert([{job_name:x,job_desc:d,job_req:b}]);if(r)throw r;w("Job successfully added!"),c(),f(""),v(""),n("")}catch(r){p(r.message)}finally{u(!1)}};return e.jsx(e.Fragment,{children:e.jsx(B,{open:y,onClose:c,"aria-labelledby":"modal-title","aria-describedby":"modal-description",children:e.jsxs(E,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},children:[e.jsx(m,{id:"modal-title",variant:"h6",component:"h2",children:"Add New Job"}),e.jsx(J,{fullWidth:!0,label:"Job Title",value:x,onChange:r=>f(r.target.value),sx:{mb:2}}),e.jsx(J,{fullWidth:!0,multiline:!0,rows:4,label:"Job Description",value:d,onChange:r=>v(r.target.value),sx:{mb:2}}),e.jsx(J,{fullWidth:!0,multiline:!0,rows:4,label:"Job Requirements",value:b,onChange:r=>n(r.target.value),sx:{mb:2}}),o&&e.jsx(m,{color:"error",children:o}),e.jsx(j,{variant:"contained",color:"primary",onClick:S,disabled:l,sx:{mr:2},children:l?"Adding...":"Add Job"}),e.jsx(j,{variant:"outlined",color:"secondary",onClick:c,children:"Cancel"})]})})})},K=()=>{const[y,c]=a.useState([]),[w,x]=a.useState(!0);a.useState(null);const[f,d]=a.useState(!1),[v,b]=a.useState(null),[n,l]=a.useState(null),[u,o]=a.useState(null),p=R();a.useEffect(()=>{(async()=>{try{const{data:t,error:i}=await g.from("category").select("id, job_name, job_desc, job_req");if(i)throw i;c(t)}catch(t){o(t.message)}finally{x(!1)}})()},[n]);const S=()=>{b(null),d(!0)},r=()=>{d(!1)},_=s=>{p(`/jobs/${s}`)},D=async s=>{try{const{error:t}=await g.from("category").delete().eq("id",s);if(t)throw t;l("Job successfully deleted!")}catch(t){o(t.message)}},M=async(s,t)=>{try{const{error:i}=await g.from("category").update({is_active:!t}).eq("id",s);if(i)throw i;c(q=>q.map(C=>C.id===s?{...C,is_active:!t}:C))}catch(i){o(i.message)}};return e.jsxs(N,{title:"Job Listings",secondary:e.jsx(V,{link:"/job-listings"}),children:[e.jsx(W,{component:H,children:e.jsxs(F,{children:[e.jsx(I,{children:e.jsxs(T,{children:[e.jsx(h,{children:e.jsx(m,{variant:"h6",children:"Title"})}),e.jsx(h,{children:e.jsx(m,{variant:"h6",children:"Action"})}),e.jsx(h,{children:e.jsx(m,{variant:"h6",children:"Active"})})]})}),e.jsx(O,{children:y.map(s=>e.jsxs(T,{children:[e.jsx(h,{children:s.job_name}),e.jsxs(h,{children:[e.jsx(j,{variant:"contained",color:"primary",onClick:()=>_(s.id),sx:{mr:1},children:"View"}),e.jsx(j,{variant:"contained",color:"error",onClick:()=>D(s.id),sx:{ml:1},children:"Delete"})]}),e.jsx(h,{children:e.jsx(L,{checked:s.is_active,onChange:()=>M(s.id,s.is_active),color:"primary"})})]},s.id))})]})}),e.jsx(j,{variant:"contained",color:"primary",onClick:S,sx:{mt:2},children:"Add New Job"}),e.jsx(P,{open:f,onClose:r,setSuccessMessage:l}),n&&e.jsx(k,{open:!!n,autoHideDuration:6e3,onClose:()=>l(null),children:e.jsx(A,{onClose:()=>l(null),severity:"success",children:n})}),u&&e.jsx(k,{open:!!u,autoHideDuration:6e3,onClose:()=>o(null),children:e.jsx(A,{onClose:()=>o(null),severity:"error",children:u})})]})};export{K as default};
