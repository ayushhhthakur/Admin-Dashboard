import{a9 as P,R as W,r as o,j as e,T as n,G as A,B as j,S as G,H as x,x as b}from"./index-DmmLrvYi.js";import{s as f}from"./supabase--8ANMFph.js";import{d as H}from"./ArrowBackIos-BVhQ_4y0.js";import{S as L,A as M}from"./Snackbar-GfMR6gKJ.js";const v=i=>i.split(`
`).map(l=>l.trim()).filter(l=>l.length>0),K=()=>{const{jobId:i}=P(),l=W(),[s,_]=o.useState(null),[S,k]=o.useState(!0),[g,q]=o.useState(null),[C,m]=o.useState(!1),[a,c]=o.useState({job_name:"",job_desc:"",job_req:""}),[E,h]=o.useState(!1),[w,d]=o.useState(""),[D,u]=o.useState("success");o.useEffect(()=>{(async()=>{try{const{data:t,error:y}=await f.from("category").select("id, job_name, job_desc, job_req").eq("id",i).single();if(y)throw y;_(t),c({job_name:t.job_name,job_desc:t.job_desc,job_req:t.job_req})}catch(t){q(t.message)}finally{k(!1)}})()},[i]);const J=()=>{m(!0)},T=()=>{m(!1),c({job_name:s.job_name,job_desc:s.job_desc,job_req:s.job_req})},B=async()=>{try{const{error:r}=await f.from("category").update({job_name:a.job_name,job_desc:a.job_desc,job_req:a.job_req}).eq("id",i);if(r)throw r;_(a),m(!1),d("Job details updated successfully"),u("success")}catch(r){d(`Error: ${r.message}`),u("error")}finally{h(!0)}},R=async()=>{try{const{error:r}=await f.from("category").delete().eq("id",i);if(r)throw r;l("/utils/jobs"),d("Job deleted successfully"),u("success")}catch(r){d(`Error: ${r.message}`),u("error")}finally{h(!0)}},p=()=>{h(!1)};if(S)return e.jsx(n,{children:"Loading..."});if(g)return e.jsxs(n,{children:["Error: ",g]});const F=v((s==null?void 0:s.job_desc)||""),I=v((s==null?void 0:s.job_req)||"");return e.jsxs(A,{children:[e.jsxs(j,{sx:{display:"flex",alignItems:"center",cursor:"pointer",mb:2},onClick:()=>window.history.back(),children:[e.jsx(H,{}),e.jsx(n,{variant:"body1",sx:{ml:1},children:"Back"})]}),e.jsxs(j,{sx:{p:3},children:[s?e.jsx(G,{sx:{p:3},children:C?e.jsxs(e.Fragment,{children:[e.jsx(x,{label:"Job Title",fullWidth:!0,variant:"outlined",margin:"normal",value:a.job_name,onChange:r=>c({...a,job_name:r.target.value})}),e.jsx(x,{label:"Description",fullWidth:!0,variant:"outlined",margin:"normal",multiline:!0,rows:4,value:a.job_desc,onChange:r=>c({...a,job_desc:r.target.value})}),e.jsx(x,{label:"Requirements",fullWidth:!0,variant:"outlined",margin:"normal",multiline:!0,rows:4,value:a.job_req,onChange:r=>c({...a,job_req:r.target.value})}),e.jsxs(j,{sx:{mt:2},children:[e.jsx(b,{variant:"contained",color:"primary",onClick:B,sx:{mr:1},children:"Save Changes"}),e.jsx(b,{variant:"outlined",color:"secondary",onClick:T,children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"h4",children:s.job_name}),e.jsx(n,{variant:"h6",sx:{mt:2},children:"Description"}),e.jsx("ul",{children:F.map((r,t)=>e.jsx("li",{children:r},t))}),e.jsx(n,{variant:"h6",sx:{mt:2},children:"Requirements"}),e.jsx("ul",{children:I.map((r,t)=>e.jsx("li",{children:r},t))}),e.jsxs(j,{sx:{mt:2},children:[e.jsx(b,{variant:"contained",color:"primary",onClick:J,sx:{mr:1},children:"Edit"}),e.jsx(b,{variant:"contained",color:"error",onClick:R,children:"Delete"})]})]})}):e.jsx(n,{children:"No job details found."}),e.jsx(L,{open:E,autoHideDuration:6e3,onClose:p,children:e.jsx(M,{onClose:p,severity:D,children:w})})]})]})};export{K as default};
